<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MakalahGen - Professional Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap');

    body {
      font-family: 'Plus Jakarta Sans', sans-serif;
      background-color: #fcfcfd;
      color: #1e293b;
    }

    .input-field {
      width: 100%;
      padding: 0.75rem 1rem;
      background-color: #ffffff;
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      outline: none;
      transition: all 0.2s;
      display: block;
    }

    .input-field:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .card-gradient {
      background: linear-gradient(to bottom right, #ffffff, #f8fafc);
      border: 1px solid #f1f5f9;
    }

    .btn-generate {
      background: #2563eb;
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 0.75rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.2s;
      box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.2);
    }

    .btn-generate:hover {
      background: #1d4ed8;
      transform: translateY(-1px);
      box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.3);
    }

    .preview-image {
      transition: transform 0.3s ease;
      cursor: zoom-in;
    }

    .preview-image:hover {
      transform: scale(1.02);
    }

    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f5f9;
    }

    ::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 4px;
    }
  </style>
</head>

<body class="antialiased">
  <nav class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-gray-100">
    <div class="max-w-5xl mx-auto px-6 py-4 flex justify-between items-center">
      <div class="flex items-center gap-2">
        <div class="bg-blue-600 p-1.5 rounded-lg"><i data-lucide="file-text" class="text-white w-5 h-5"></i></div>
        <span class="text-xl font-bold tracking-tight">Makalah<span class="text-blue-600">Gen.</span></span>
      </div>
      <button form="mainForm" type="submit" class="btn-generate">
        <i data-lucide="zap" class="w-4 h-4 text-yellow-300"></i> Generate Sekarang
      </button>
    </div>
  </nav>

  <main class="max-w-5xl mx-auto px-6 py-10">
    <form id="mainForm" method="POST" action="/generate" enctype="multipart/form-data">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">

        <div class="md:col-span-2 space-y-8">

          <section class="card-gradient p-8 rounded-2xl shadow-sm">
            <div class="flex items-center gap-3 mb-6">
              <i data-lucide="layout" class="text-blue-500 w-5 h-5"></i>
              <h2 class="text-lg font-bold">Identitas Makalah</h2>
            </div>
            <div class="space-y-4">
              <div>
                <label class="text-xs font-bold text-gray-400 uppercase tracking-wider ml-1">Judul Utama</label>
                <textarea name="JUDUL-MAKALAH" class="input-field mt-1" placeholder="Masukkan judul lengkap..."
                  required></textarea>
              </div>

              <div>
                <label class="text-xs font-bold text-gray-400 uppercase tracking-wider ml-1">Logo Universitas
                  (Custom)</label>
                <input type="file" name="logo_custom" accept="image/*" class="input-field mt-1 text-sm border-dashed"
                  onchange="">

                <div class="mt-2 p-3 bg-amber-50 border border-amber-100 rounded-lg">
                  <p class="text-[10px] text-amber-700 leading-relaxed">
                    <i data-lucide="alert-circle" class="inline-block w-3 h-3 mr-1"></i>
                    <strong>Tips Ukuran Agar Tidak Gepeng:</strong><br>
                    Gunakan gambar dengan lebar maksimal <strong>500px</strong>. Jika logo melebar (seperti UNNES),
                    pastikan proporsi gambar sudah pas sebelum diupload. Disarankan format <strong>PNG
                      Transparan</strong>.
                    <br>
                    <!-- Logo Default Unnes -->
                    <strong>Logo Default = UNNES</strong>
                  </p>
                </div>
              </div>

              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label class="text-xs font-bold text-gray-400 uppercase tracking-wider ml-1">Dosen Pengampu</label>
                  <textarea name="DosenPengampu" class="input-field mt-1" placeholder="Nama & Gelar"></textarea>
                </div>
                <div>
                  <label class="text-xs font-bold text-gray-400 uppercase tracking-wider ml-1">Universitas</label>
                  <input name="Universitas" class="input-field mt-1" placeholder="Contoh: Universitas Negeri Semarang"
                    value="" />
                </div>
              </div>
              <div class="grid grid-cols-3 gap-4">
                <div class="col-span-2">
                  <label class="text-xs font-bold text-gray-400 uppercase tracking-wider ml-1">Fakultas & Prodi</label>
                  <div class="flex gap-2 mt-1">
                    <input name="Fakultas" class="input-field" placeholder="Fakultas" />
                    <input name="ProgramStudi" class="input-field" placeholder="Prodi" />
                  </div>
                </div>
                <div>
                  <label class="text-xs font-bold text-gray-400 uppercase tracking-wider ml-1">Tahun</label>
                  <input name="Tahun" class="input-field mt-1" placeholder="2026" value="2026" />
                </div>
              </div>
            </div>
          </section>

          <section class="card-gradient p-8 rounded-2xl shadow-sm">
            <div class="flex justify-between items-center mb-6">
              <div class="flex items-center gap-3">
                <i data-lucide="users" class="text-blue-500 w-5 h-5"></i>
                <h2 class="text-lg font-bold">Anggota Kelompok</h2>
              </div>
              <button type="button" onclick="addAnggota()"
                class="text-sm bg-blue-50 text-blue-600 px-3 py-1.5 rounded-full font-semibold hover:bg-blue-100 transition-colors">+
                Tambah</button>
            </div>
            <div id="anggotaContainer" class="space-y-3"></div>
          </section>

          <div id="babContainer" class="space-y-6"></div>

          <button type="button" onclick="addBab()"
            class="w-full py-4 border-2 border-dashed border-gray-200 rounded-2xl text-gray-400 font-medium hover:border-blue-400 hover:text-blue-500 hover:bg-blue-50/50 transition-all flex items-center justify-center gap-2">
            <i data-lucide="plus-circle" class="w-5 h-5"></i> Tambah Bab Baru
          </button>

          <section class="card-gradient p-8 rounded-2xl shadow-sm">
            <div class="flex items-center gap-3 mb-4 text-blue-600">
              <i data-lucide="book-open" class="w-5 h-5"></i>
              <h3 class="font-bold">Daftar Pustaka (Structured)</h3>
            </div>
            <label class="text-xs font-bold text-gray-400 uppercase tracking-wider ml-1">Style Referensi</label>
            <select name="referensi_style" class="input-field mt-1 mb-4">
              <option value="APA">APA Style</option>
              <option value="MLA">MLA Style</option>
              <option value="Chicago">Chicago Style</option>
            </select>
            <div id="referensiContainer" class="space-y-4 mb-4"></div>
            <button type="button" onclick="addReferensi()"
              class="text-sm bg-blue-50 text-blue-600 px-4 py-2 rounded-full font-semibold hover:bg-blue-100 transition-colors">+
              Tambah Referensi</button>
          </section>
        </div>

        <div class="space-y-6">

          <section class="card-gradient p-6 rounded-2xl shadow-sm border border-blue-100">
            <div class="flex items-center gap-3 mb-4 text-blue-600">
              <i data-lucide="image" class="w-5 h-5"></i>
              <h3 class="font-bold">Preview Layout Cover</h3>
            </div>
            <div class="relative group">
              <div class="overflow-hidden rounded-xl border border-gray-200 bg-gray-50">
                <img id="coverPreviewImg" src="./image/cover.png" alt="Contoh Cover Makalah"
                  class="preview-image w-full h-auto object-cover"
                  onerror="this.src='https://placehold.co/400x560?text=Preview+Cover+Not+Found'"
                  onclick="window.open(this.src, '_blank')">
              </div>
              <div
                class="absolute bottom-3 left-3 right-3 bg-white/90 backdrop-blur-sm p-2 rounded-lg border border-gray-100 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none">
                <p class="text-[10px] text-gray-500 text-center font-medium">Format A4 - Margin 4433</p>
              </div>
            </div>
            <p class="mt-3 text-[11px] text-gray-400 leading-relaxed italic">
              *Klik gambar untuk melihat resolusi penuh. Layout akan disesuaikan dengan data identitas.
            </p>
          </section>

          <section class="card-gradient p-6 rounded-2xl shadow-sm border border-gray-100">
            <div class="flex items-center gap-3 mb-4 text-blue-600">
              <i data-lucide="align-left" class="w-5 h-5"></i>
              <h3 class="font-bold text-sm">Referensi Gaya Indentasi</h3>
            </div>
            <div class="space-y-4">
              <div class="space-y-1">
                <span class="text-[10px] font-bold text-gray-400 uppercase">Every Paragraph</span>
                <img src="./image/everyParagraph.png"
                  class="rounded-lg border border-gray-100 w-full hover:border-blue-300 transition-colors"
                  alt="Every Paragraph Preview">
              </div>
              <div class="space-y-1">
                <span class="text-[10px] font-bold text-gray-400 uppercase">Only Start</span>
                <img src="./image/onlystart.png"
                  class="rounded-lg border border-gray-100 w-full hover:border-blue-300 transition-colors"
                  alt="Only Start Preview">
              </div>
              <div class="space-y-1">
                <span class="text-[10px] font-bold text-gray-400 uppercase">No Indent</span>
                <img src="./image/noindent.png"
                  class="rounded-lg border border-gray-100 w-full hover:border-blue-300 transition-colors"
                  alt="No Indent Preview">
              </div>
            </div>
          </section>

          <section class="card-gradient p-6 rounded-2xl shadow-sm">
            <div class="flex items-center gap-3 mb-4 text-blue-600">
              <i data-lucide="calendar" class="w-5 h-5"></i>
              <h3 class="font-bold">Tanggal Terbit</h3>
            </div>
            <div class="grid grid-cols-3 gap-2">
              <input name="DD" class="input-field text-center p-2" placeholder="Tgl" value="22" />
              <input name="MM" class="input-field text-center p-2" placeholder="Bln" value="02" />
              <input name="YYYY" class="input-field text-center p-2" placeholder="Thn" value="2026" />
            </div>
          </section>

          <section class="card-gradient p-6 rounded-2xl shadow-sm">
            <div class="flex items-center gap-3 mb-4 text-blue-600">
              <i data-lucide="pen-tool" class="w-5 h-5"></i>
              <h3 class="font-bold">Kata Pengantar</h3>
            </div>
            <textarea name="Isi-KataPengantar" rows="4" class="input-field mb-2 text-sm"
              placeholder="Tulis pembukaan..."></textarea>

            <select name="indent_katapengantar" class="input-field mb-4 text-xs bg-gray-50 text-gray-600 border-dashed">
              <option value="all">Indent every paragraph</option>
              <option value="first">Indent only start of section</option>
              <option value="none" selected>No indent</option>
            </select>

            <input name="Author" class="input-field text-sm" placeholder="Nama Penulis/Kelompok" />
          </section>

        </div>
      </div>
    </form>
  </main>

  <script>
    let anggotaCount = 0;
    let babCount = 0;
    let referensiCount = 0;

    // Fungsi Preview Logo Baru
    function previewCustomLogo(input) {
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function (e) {
          document.getElementById('coverPreviewImg').src = e.target.result;
        }
        reader.readAsDataURL(input.files[0]);
      }
    }

    function addAnggota() {
      anggotaCount++;
      const container = document.getElementById("anggotaContainer");
      const div = document.createElement("div");
      div.className = "flex gap-3 animate-in fade-in duration-300";
      div.innerHTML = `
        <input name="anggota_nama_${anggotaCount}" class="input-field" placeholder="Nama Mahasiswa"/>
        <input name="anggota_nim_${anggotaCount}" class="input-field w-40" placeholder="NIM"/>
        <button type="button" onclick="this.parentElement.remove()" class="text-gray-300 hover:text-red-500"><i data-lucide="x" class="w-5 h-5"></i></button>
      `;
      container.appendChild(div);
      lucide.createIcons();
    }

    function addBab() {
      babCount++;
      const container = document.getElementById("babContainer");
      const div = document.createElement("div");
      div.className = "card-gradient p-8 rounded-2xl shadow-sm border-l-4 border-l-blue-600 animate-in slide-in-from-bottom-5 duration-500";

      div.innerHTML = `
        <div class="flex gap-4 mb-4">
          <input name="bab_nomor_${babCount}" class="input-field w-20 font-bold text-center border-blue-100" placeholder="I" value="${romanize(babCount)}"/>
          <input name="bab_judul_${babCount}" class="input-field font-bold" placeholder="Judul Bab"/>
        </div>
        
        <textarea name="bab_isi_${babCount}" rows="3" class="input-field mb-2 bg-gray-50/30" placeholder="Tuliskan isi bab..."></textarea>
        <select name="indent_bab_${babCount}" class="input-field mb-4 text-xs bg-gray-50 text-gray-600 border-dashed w-auto inline-block">
          <option value="all">Indent every paragraph</option>
          <option value="first">Indent only start of section</option>
          <option value="none">No indent</option>
        </select>

        <div id="subbab_${babCount}" class="space-y-4 ml-8 border-l-2 border-blue-50 pl-6 mt-6"></div>
        <button type="button" onclick="addSubBab(${babCount})" class="mt-4 ml-8 flex items-center gap-2 text-sm font-bold text-blue-600 hover:text-blue-700"><i data-lucide="plus" class="w-4 h-4"></i> Tambah Sub-Bab</button>
      `;
      container.appendChild(div);
      lucide.createIcons();
    }

    function addSubBab(babIndex) {
      const container = document.getElementById("subbab_" + babIndex);
      const count = container.children.length + 1;
      const div = document.createElement("div");
      div.className = "space-y-2 animate-in fade-in duration-300 bg-white p-4 border border-gray-100 rounded-xl";

      div.innerHTML = `
        <input name="subbab_judul_${babIndex}_${count}" class="input-field font-semibold bg-white mb-2" placeholder="Judul Sub-Bab"/>
        <textarea name="subbab_isi_${babIndex}_${count}" rows="2" class="input-field text-sm mb-2" placeholder="Isi sub-bab..."></textarea>
        <select name="indent_subbab_${babIndex}_${count}" class="input-field text-xs bg-gray-50 text-gray-600 border-dashed w-auto">
          <option value="all">Indent every paragraph</option>
          <option value="first">Indent only start of section</option>
          <option value="none">No indent</option>
        </select>
      `;
      container.appendChild(div);
    }

    function addReferensi() {
      referensiCount++;
      const container = document.getElementById("referensiContainer");
      const div = document.createElement("div");
      div.className = "p-4 bg-white border border-gray-100 rounded-xl relative space-y-3 shadow-sm";
      div.innerHTML = `
        <button type="button" onclick="this.parentElement.remove()" class="absolute top-2 right-2 text-gray-300 hover:text-red-500"><i data-lucide="x" class="w-4 h-4"></i></button>
        <div class="grid grid-cols-2 gap-3">
          <input name="ref_penulis_${referensiCount}" class="input-field text-sm" placeholder="Penulis (Doe, J.)">
          <input name="ref_tahun_${referensiCount}" class="input-field text-sm" placeholder="Tahun (2024)">
        </div>
        <input name="ref_judul_${referensiCount}" class="input-field text-sm" placeholder="Judul Buku/Karya">
        <div class="grid grid-cols-2 gap-3">
          <input name="ref_penerbit_${referensiCount}" class="input-field text-sm" placeholder="Penerbit/Jurnal">
          <input name="ref_kota_${referensiCount}" class="input-field text-sm" placeholder="Kota (Opsional)">
        </div>
      `;
      container.appendChild(div);
      lucide.createIcons();
    }

    function romanize(num) {
      const lookup = { M: 1000, CM: 900, D: 500, CD: 400, C: 100, XC: 90, L: 50, XL: 40, X: 10, IX: 9, V: 5, IV: 4, I: 1 };
      let roman = '';
      for (let i in lookup) {
        while (num >= lookup[i]) {
          roman += i;
          num -= lookup[i];
        }
      }
      return roman;
    }

    window.onload = () => {
      lucide.createIcons();
      addAnggota();
      addBab();
    };
  </script>
</body>

</html>